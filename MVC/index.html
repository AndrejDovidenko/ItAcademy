<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>MVC example</title>
    <style>
      body {
        font-size: 21px;
        text-align: center;
      }

      input {
        min-width: 180px;
        padding: 8px 12px;
        border: 1px gray solid;
        border-radius: 3px;
        margin: 0 5px;
      }

      button {
        font-size: 18px;
        line-height: 21px;
        padding: 10px;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <h1>Пример использования MVC</h1>

    <h3>Всего-навсего вычисление двух чисел</h3>
    <form>
      <fieldset>
        <legend>Магия чисел</legend>
        <p>
          <input
            type="number"
            placeholder="Введите первое значение"
            name="input_1"
            id="input_1"
          />
          <select class="multi-sign">
            <option>x</option>
            <option>/</option>
            <option>+</option>
            <option>-</option>
          </select>
          <input
            type="number"
            placeholder="Введите второе значение"
            name="input_2"
            id="input_2"
          />
        </p>
        <p>
          <button id="calculate-btn">Вычислить</button>
        </p>
        <div id="show-result"></div>
      </fieldset>
    </form>

    <script>
      const model = {
        firstValue: null,
        secondValue: null,
        sign: null,
        result: null,
        disabled: true,

        viewUpdate: function (flag) {
          view.update(this.result, this.disabled, flag);
        },

        setDisabled: function (boolean) {
          this.disabled = boolean;
        },

        setValues: function (firstValueState, secondValueState, signState) {
          this.firstValue = +firstValueState;
          this.secondValue = +secondValueState;
          this.sign = signState;
        },

        calculate: function () {
          switch (this.sign) {
            case "x":
              this.result = this.firstValue * this.secondValue;
              break;
            case "/":
              if (!this.secondValue) {
                this.result = "Деление но ноль невозможно!";
              } else {
                this.result = this.firstValue / this.secondValue;
              }
              break;
            case "+":
              this.result = this.firstValue + this.secondValue;
              break;
            case "-":
              this.result = this.firstValue - this.secondValue;
              break;
          }
          this.viewUpdate(1);
        },
      };

      const view = {
        showResult: document.querySelector("#show-result"),
        button: document.querySelector("#calculate-btn"),

        update: function (value, boolean, flag) {
          this.button.disabled = boolean;
          if (!flag) {
            this.showResult.textContent = "";
          } else {
            this.showResult.textContent = "Результат вычисления = " + value;
          }
        },
      };

      const controller = {
        addListeners: function () {
          const form = document.querySelector("form");
          const button = document.querySelector("#calculate-btn");
          const firstInput = document.querySelector("#input_1");
          const secondInput = document.querySelector("#input_2");
          const select = document.querySelector(".multi-sign");

          form.addEventListener("input", () => {
            if (firstInput.value && secondInput.value) {
              model.setDisabled(false);
              model.setValues(
                firstInput.value,
                secondInput.value,
                select.value
              );
            } else {
              model.setDisabled(true);
            }
            model.viewUpdate(0);
          });

          button.addEventListener("click", (e) => {
            e.preventDefault();
            model.calculate(0);
          });
        },
      };

      model.viewUpdate(0);
      controller.addListeners();
    </script>
  </body>
</html>
